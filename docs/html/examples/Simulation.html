

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Building and running a simulation &mdash; Tidy3d  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/logo.svg"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Photonic crystal slab cavity" href="L3_cavity.html" />
    <link rel="prev" title="Examples" href="../examples.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Tidy3d
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Building and running a simulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Initialize-structures,-sources-and-probes">Initialize structures, sources and probes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Create-and-inspect-the-simulation">Create and inspect the simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Run-the-simulation">Run the simulation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Loading-and-analyzing-data">Loading and analyzing data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Load-a-simulation-from-JSON-file">Load a simulation from JSON file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Visualization-functions">Visualization functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Raw-data-in-Simulation-object-and-in-hdf5-file">Raw data in Simulation object and in hdf5 file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="L3_cavity.html">Photonic crystal slab cavity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Tidy3d</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../examples.html">Examples</a> &raquo;</li>
        
      <li>Building and running a simulation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/Simulation.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Building-and-running-a-simulation">
<h1>Building and running a simulation<a class="headerlink" href="#Building-and-running-a-simulation" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">h5py</span>

<span class="kn">import</span> <span class="nn">tidy3dclient</span> <span class="k">as</span> <span class="nn">td</span>
<span class="kn">from</span> <span class="nn">tidy3dclient</span> <span class="kn">import</span> <span class="n">web</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
</pre></div></div>
</div>
<div class="section" id="Initialize-structures,-sources-and-probes">
<h2>Initialize structures, sources and probes<a class="headerlink" href="#Initialize-structures,-sources-and-probes" title="Permalink to this headline">¶</a></h2>
<p>In this example, we will simulate a rectangular dielectric Box pierced by a triangular pillar made of lossy dielectric. First we initialize some general simulation parameters.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Resolution in x, y, z (points per micron)</span>
<span class="n">resolution</span> <span class="o">=</span> <span class="mi">40</span>

<span class="c1"># Simulation domain size (in micron)</span>
<span class="n">sim_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="c1"># Central frequency of interest in Hz</span>
<span class="n">fcen</span> <span class="o">=</span> <span class="mf">2e14</span>

<span class="c1"># Total time to run in seconds</span>
<span class="n">run_time</span> <span class="o">=</span> <span class="mf">1.5e-12</span>

<span class="c1"># Number of PML layers to use along each of the three directions.</span>
<span class="n">pml_layers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Next, we initialize two different structures made of two different materials.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Lossless dielectric</span>
<span class="n">material1</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">Medium</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mf">6.</span><span class="p">)</span>
<span class="c1"># Lossy dielectric defined from real and imaginary part of the refractive index</span>
<span class="n">material2</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">Medium</span><span class="o">.</span><span class="n">from_nk</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">fcen</span><span class="p">)</span>

<span class="c1"># Rectangular box</span>
<span class="n">box</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">material</span><span class="o">=</span><span class="n">material1</span><span class="p">)</span>
<span class="c1"># Triangle in the xy-plane with a finite extent in z</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">PolySlab</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span>
                <span class="n">z_cent</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">z_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">material</span><span class="o">=</span><span class="n">material2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Next, we define a source and some field probes. Here, the excitation is a 2D plane-wave source spanning the whole simulation domain at a given cross-section. We also define a time probe recording the E-field at a point in the center of the simulation domain, and two frequency probes recording the DFT of the E-field at the central frequency in two different 2D planes.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">psource</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">PlaneSource</span><span class="p">(</span><span class="n">normal</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span>
                         <span class="n">pos_offset</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">,</span>
                         <span class="n">f0</span><span class="o">=</span><span class="n">fcen</span><span class="p">,</span>
                         <span class="n">fwidth</span><span class="o">=</span><span class="mf">1e13</span><span class="p">,</span>
                         <span class="n">polarization</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

<span class="n">tprobe</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">TimeProbe</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">fprobe1</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">FreqProbe</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="n">freqs</span><span class="o">=</span><span class="p">[</span><span class="n">fcen</span><span class="p">])</span>
<span class="n">fprobe2</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">FreqProbe</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">freqs</span><span class="o">=</span><span class="p">[</span><span class="n">fcen</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Create-and-inspect-the-simulation">
<h2>Create and inspect the simulation<a class="headerlink" href="#Create-and-inspect-the-simulation" title="Permalink to this headline">¶</a></h2>
<p>Now we can initialize the simulation with all the elements defined above.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Initialize simulation</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">sim_size</span><span class="p">,</span>
                    <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">,</span>
                    <span class="n">structures</span><span class="o">=</span><span class="p">[</span><span class="n">box</span><span class="p">,</span> <span class="n">poly</span><span class="p">],</span>
                    <span class="n">sources</span><span class="o">=</span><span class="p">[</span><span class="n">psource</span><span class="p">],</span>
                    <span class="n">probes</span><span class="o">=</span><span class="p">[</span><span class="n">tprobe</span><span class="p">,</span> <span class="n">fprobe1</span><span class="p">,</span> <span class="n">fprobe2</span><span class="p">],</span>
                    <span class="n">run_time</span><span class="o">=</span><span class="n">run_time</span><span class="p">,</span>
                    <span class="n">pml_layers</span><span class="o">=</span><span class="n">pml_layers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Initializing simulation...
Simulation domain in number of pixels: 200, 200, 200.
Mesh step (micron): 2.50e-02, 2.50e-02, 2.50e-02.
Total number of time steps: 34618.
Estimated data size of probe tprobe1: 0.0004GB.
Estimated data size of probe fprobe1: 0.0005GB.
Estimated data size of probe fprobe2: 0.0005GB.
</pre></div></div>
</div>
<p>We can use an in-built plotting function to make sure that the source time dependence makes sense with respect to the total simulation time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">td</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">source_time</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Tidy3D GaussianSource:
name         = source1
center       = [-1.5000 0.0000 0.0000]
size         = [0.0000 5.0000 5.0000]
f0           = 2.00e+14
fwidth       = 1.00e+13
polarization = y
offset       = 5.00
amplitude    = 1.00e+00

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Simulation_11_1.png" src="../_images/examples_Simulation_11_1.png" />
</div>
</div>
<p>We also use an in-built plotting function to visualize the simulation. We plot three cross sections at <code class="docutils literal notranslate"><span class="pre">z=0</span></code>, <code class="docutils literal notranslate"><span class="pre">y=0</span></code>, and <code class="docutils literal notranslate"><span class="pre">x=0</span></code>, respectively. The relative permittivity of objects is plotted in greyscale. By default, sources are overlayed in green, probes in yellow, and PML boundaries in orange, but each of those can be switched off with the corresponding tag.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">td</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">relative_eps</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">normal</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sources</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">probes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pml</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">td</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">relative_eps</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">normal</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sources</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">probes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pml</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">td</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">relative_eps</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">normal</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sources</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">probes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pml</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Simulation_13_0.png" src="../_images/examples_Simulation_13_0.png" />
</div>
</div>
<p>The left-most image is entirely overlaid in yellow to show the frequency probe at z=0.</p>
</div>
<div class="section" id="Run-the-simulation">
<h2>Run the simulation<a class="headerlink" href="#Run-the-simulation" title="Permalink to this headline">¶</a></h2>
<p>Now that the simulation is constructed, we can run it using the <code class="docutils literal notranslate"><span class="pre">web</span></code> API of Tidy3D. First, we submit the project. Note that we can give it a custom name.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">project</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">newProject</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">export</span><span class="p">(),</span> <span class="n">taskName</span><span class="o">=</span><span class="s1">&#39;Simulation test&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can monitor the status of all our projects by listing them in chronological order of submission.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Check status (of the last 5 submitted projects)</span>
<span class="n">web</span><span class="o">.</span><span class="n">listProjects</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Project name: Simulation test-6
Task ID     : ad0739af-cd3c-4e49-98b8-1460a3746538
Submit time : 2021:01:06:03:37:26
Status      : queued
--------------------------------------------------
Project name: Simulation test-5
Task ID     : 0565e95f-c4d0-48d7-a021-d6e082f857e2
Submit time : 2021:01:06:03:31:19
Status      : success
--------------------------------------------------
Project name: MZI-4
Task ID     : 7d9e9094-24b9-4a7c-96bc-2d078677ff5c
Submit time : 2021:01:05:03:33:31
Status      : success
--------------------------------------------------
Project name: MZI-phase-shifter
Task ID     : 1b81c52b-736f-4645-98f3-160d157ef1b3
Submit time : 2021:01:05:03:26:55
Status      : success
--------------------------------------------------
Project name: MZI-2
Task ID     : 2b19b062-b5ee-4637-b158-bbd68f707a07
Submit time : 2021:01:05:01:37:05
Status      : success
--------------------------------------------------
</pre></div></div>
</div>
<p>Or, we can continously monitor the status of the current project, and wait until the run is successful. The <code class="docutils literal notranslate"><span class="pre">monitorProject()</span></code> function will keep running until either a <code class="docutils literal notranslate"><span class="pre">'success'</span></code> or <code class="docutils literal notranslate"><span class="pre">'error'</span></code> status is returned.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">web</span><span class="o">.</span><span class="n">monitorProject</span><span class="p">(</span><span class="n">project</span><span class="p">[</span><span class="s1">&#39;taskId&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Project &#34;Simulation test-6&#34; status: success...
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Loading-and-analyzing-data">
<h1>Loading and analyzing data<a class="headerlink" href="#Loading-and-analyzing-data" title="Permalink to this headline">¶</a></h1>
<p>After a successful run, we can download the results and load them into our simulation model. We use the <code class="docutils literal notranslate"><span class="pre">downloadResults</span></code> function from our web API, which downloads a single <code class="docutils literal notranslate"><span class="pre">hdf5</span></code> file containing all the probe data, a log file, and a <code class="docutils literal notranslate"><span class="pre">json</span></code> file defining the original simulation (same as what you’ll get if you run <code class="docutils literal notranslate"><span class="pre">sim.export_json()</span></code> on the current object). Optionally, you can provide a folder in which to store the files.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">web</span><span class="o">.</span><span class="n">downloadResults</span><span class="p">(</span><span class="n">project</span><span class="p">[</span><span class="s1">&#39;taskId&#39;</span><span class="p">],</span> <span class="n">target_folder</span><span class="o">=</span><span class="s1">&#39;out/&#39;</span><span class="p">)</span>
<span class="c1"># Show the output of the log file</span>
<span class="o">!</span>cat out/tidy3d.log
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Simulation domain Nx, Ny, Nz: 200, 200, 200.
Total number of nodes (after symmetries, if any): 8.00e+06.
Total number of time steps: 34618.
Starting Tidy3D...

Setup time (s): 0.3543
Solver time (s): 44.6787
Post-processing time (s): 0.5377
</pre></div></div>
</div>
<div class="section" id="Load-a-simulation-from-JSON-file">
<h2>Load a simulation from JSON file<a class="headerlink" href="#Load-a-simulation-from-JSON-file" title="Permalink to this headline">¶</a></h2>
<p>In case we are returning to a project for which we do not have an active simulation object, we can re-initialize the simulation from the freshly downloaded <code class="docutils literal notranslate"><span class="pre">json</span></code> file. Below, we load the file from the project we just ran, and load the ouput data downloaded from the server.</p>
<p><strong>NB</strong>: when running the notebook from the beginning, it is not needed to call <code class="docutils literal notranslate"><span class="pre">import_json()</span></code>, as the current Simulation is stored in memory. Here we do it to illustrate how this function can be used, essentially re-initializing the same Simulation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">Simulation</span><span class="o">.</span><span class="n">import_json</span><span class="p">(</span><span class="s2">&quot;out/simulation.json&quot;</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">load_results</span><span class="p">(</span><span class="s1">&#39;out/probe_data.hdf5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Visualization-functions">
<h2>Visualization functions<a class="headerlink" href="#Visualization-functions" title="Permalink to this headline">¶</a></h2>
<p>Finally, we can now use the in-built visualization tools to examine the results. Below, we plot the <code class="docutils literal notranslate"><span class="pre">y</span></code>-component of the field recorded by the two frequency probes (this is the dominant component since the source is <code class="docutils literal notranslate"><span class="pre">y</span></code>-polarized).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">td</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">fprobe_2D</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">probe_ind</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="s1">&#39;re&#39;</span><span class="p">);</span>
<span class="n">td</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">fprobe_2D</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">probe_ind</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="s1">&#39;re&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Simulation_27_0.png" src="../_images/examples_Simulation_27_0.png" />
</div>
</div>
</div>
<div class="section" id="Raw-data-in-Simulation-object-and-in-hdf5-file">
<h2>Raw data in Simulation object and in hdf5 file<a class="headerlink" href="#Raw-data-in-Simulation-object-and-in-hdf5-file" title="Permalink to this headline">¶</a></h2>
<p>The raw data is also accessible as numpy arrays. Each frequency probe for example has attribute <code class="docutils literal notranslate"><span class="pre">E</span></code> that stores the data as a 5D array with shape (3, Nx, Ny, Nz, Nfreqs), where the first dimension is polarization, and the last dimension is the number of frequencies in the frequency probe.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">fprobes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Size of E-field array stored in probe 0: &quot;</span><span class="p">,</span> <span class="n">sim</span><span class="o">.</span><span class="n">fprobes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">E</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Size of corresponding mesh in x        : &quot;</span><span class="p">,</span> <span class="n">sim</span><span class="o">.</span><span class="n">fprobes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xmesh</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Size of corresponding mesh in y        : &quot;</span><span class="p">,</span> <span class="n">sim</span><span class="o">.</span><span class="n">fprobes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ymesh</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Size of corresponding mesh in z        : &quot;</span><span class="p">,</span> <span class="n">sim</span><span class="o">.</span><span class="n">fprobes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">zmesh</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Tidy3D FreqProbe:
name     = fprobe1
center   = [1.5000 0.0000 0.0000]
size     = [0.0000 20.0000 20.0000]
freqs    = [2.00e+14]

Store E:  True
Store H:  False
Has data: xmesh, ymesh, zmesh, freqs, E


Size of E-field array stored in probe 0:  (3, 1, 200, 200, 1)
Size of corresponding mesh in x        :  (1,)
Size of corresponding mesh in y        :  (200,)
Size of corresponding mesh in z        :  (200,)
</pre></div></div>
</div>
<p>We can use this raw data for example to also plot the time-domain fields recorded in the TimeProbe, which look largely like a delayed version of the source input, indicating that no resonant features were excited.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">tprobes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tmesh</span><span class="p">,</span> <span class="n">sim</span><span class="o">.</span><span class="n">tprobes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.4e-12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Ey [a. u.]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Simulation_31_0.png" src="../_images/examples_Simulation_31_0.png" />
</div>
</div>
<p>Finally, the raw data is also accessible through the <code class="docutils literal notranslate"><span class="pre">hdf5</span></code> file.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Open the data file and print stored groups and datasets</span>
<span class="n">probe_file</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s2">&quot;out/probe_data.hdf5&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data groups stored in file:   &quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">probe_file</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Datasets in &#39;fprobe_fprobe1&#39;: &quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">probe_file</span><span class="p">[</span><span class="s1">&#39;fprobe_fprobe1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>

<span class="c1"># Read the E-field of the second FreqProbe</span>
<span class="n">E_hdf5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">probe_file</span><span class="p">[</span><span class="s1">&#39;fprobe_fprobe2&#39;</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">])</span>
<span class="n">x_hdf5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">probe_file</span><span class="p">[</span><span class="s1">&#39;fprobe_fprobe2&#39;</span><span class="p">][</span><span class="s1">&#39;xmesh&#39;</span><span class="p">])</span>
<span class="n">y_hdf5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">probe_file</span><span class="p">[</span><span class="s1">&#39;fprobe_fprobe2&#39;</span><span class="p">][</span><span class="s1">&#39;ymesh&#39;</span><span class="p">])</span>

<span class="c1"># Close the file</span>
<span class="n">probe_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Data groups stored in file:    [&#39;fprobe_fprobe1&#39;, &#39;fprobe_fprobe2&#39;, &#39;tprobe_tprobe1&#39;]
Datasets in &#39;fprobe_fprobe1&#39;:  [&#39;E&#39;, &#39;H&#39;, &#39;freqs&#39;, &#39;indspan&#39;, &#39;xmesh&#39;, &#39;ymesh&#39;, &#39;zmesh&#39;]
</pre></div></div>
</div>
<p>We can plot the field using the in-built function, or do it manually.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="c1"># Built-in Tidy3D viz</span>
<span class="n">td</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">fprobe_2D</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">probe_ind</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="s1">&#39;re&#39;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
<span class="c1"># Manually from data loaded from the hdf5 file</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">E_hdf5</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">x_hdf5</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_hdf5</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_hdf5</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_hdf5</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Simulation_35_0.png" src="../_images/examples_Simulation_35_0.png" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="L3_cavity.html" class="btn btn-neutral float-right" title="Photonic crystal slab cavity" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../examples.html" class="btn btn-neutral float-left" title="Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright Flexcompute 2020

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>